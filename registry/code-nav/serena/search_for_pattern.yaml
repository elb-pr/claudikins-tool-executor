name: search_for_pattern
server: serena
category: code-nav
description: |-
  Offers a flexible search for arbitrary patterns in the codebase, including the
  possibility to search in non-code files.
  Generally, symbolic operations like find_symbol or find_referencing_symbols
  should be preferred if you know which symbols you are looking for.

  Pattern Matching Logic:
      For each match, the returned result will contain the full lines where the
      substring pattern is found, as well as optionally some lines before and after it. The pattern will be compiled with
      DOTALL, meaning that the dot will match all characters including newlines.
      This also means that it never makes sense to have .* at the beginning or end of the pattern,
      but it may make sense to have it in the middle for complex patterns.
      If a pattern matches multiple lines, all those lines will be part of the match.
      Be careful to not use greedy quantifiers unnecessarily, it is usually better to use non-greedy quantifiers like .*? to avoid
      matching too much content.

  File Selection Logic:
      The files in which the search is performed can be restricted very flexibly.
      Using `restrict_search_to_code_files` is useful if you are only interested in code symbols (i.e., those
      symbols that can be manipulated with symbolic tools like find_symbol).
      You can also restrict the search to a specific file or directory,
      and provide glob patterns to include or exclude certain files on top of that.
      The globs are matched against relative file paths from the project root (not to the `relative_path` parameter that
      is used to further restrict the search).
      Smartly combining the various restrictions allows you to perform very targeted searches. Returns A mapping of file paths to lists of matched consecutive lines.
inputSchema:
  type: object
  properties:
    substring_pattern:
      title: Substring Pattern
      type: string
      description: Regular expression for a substring pattern to search for.
    context_lines_before:
      default: 0
      title: Context Lines Before
      type: integer
      description: Number of lines of context to include before each match.
    context_lines_after:
      default: 0
      title: Context Lines After
      type: integer
      description: Number of lines of context to include after each match.
    paths_include_glob:
      default: ''
      title: Paths Include Glob
      type: string
      description: |-
        Optional glob pattern specifying files to include in the search.
        Matches against relative file paths from the project root (e.g., "*.py", "src/**/*.ts").
        Supports standard glob patterns (*, ?, [seq], **, etc.) and brace expansion {a,b,c}.
        Only matches files, not directories. If left empty, all non-ignored files will be included.
    paths_exclude_glob:
      default: ''
      title: Paths Exclude Glob
      type: string
      description: >-
        Optional glob pattern specifying files to exclude from the search.

        Matches against relative file paths from the project root (e.g., "*test*", "**/*_generated.py").

        Supports standard glob patterns (*, ?, [seq], **, etc.) and brace expansion {a,b,c}.

        Takes precedence over paths_include_glob. Only matches files, not directories. If left empty, no files are
        excluded.
    relative_path:
      default: ''
      title: Relative Path
      type: string
      description: |-
        Only subpaths of this path (relative to the repo root) will be analyzed. If a path to a single
        file is passed, only that will be searched. The path must exist, otherwise a `FileNotFoundError` is raised.
    restrict_search_to_code_files:
      default: false
      title: Restrict Search To Code Files
      type: boolean
      description: |-
        Whether to restrict the search to only those files where
        analyzed code symbols can be found. Otherwise, will search all non-ignored files.
        Set this to True if your search is only meant to discover code that can be manipulated with symbolic tools.
        For example, for finding classes or methods from a name pattern.
        Setting to False is a better choice if you also want to search in non-code files, like in html or yaml files,
        which is why it is the default.
    max_answer_chars:
      default: -1
      title: Max Answer Chars
      type: integer
      description: |-
        If the output is longer than this number of characters,
        no content will be returned.
        -1 means the default value from the config will be used.
        Don't adjust unless there is really no other way to get the content
        required for the task. Instead, if the output is too long, you should
        make a stricter query.
  required:
    - substring_pattern
  title: applyArguments
example: |-
  // Find all TODO comments with context
  await serena["search_for_pattern"]({
    substring_pattern: "TODO:",
    context_lines_before: 1,
    context_lines_after: 2
  });

  // Search for function definitions in TypeScript files
  await serena["search_for_pattern"]({
    substring_pattern: "async function",
    paths_include_glob: "**/*.ts",
    restrict_search_to_code_files: true
  });

  // Find API endpoints in a specific directory
  await serena["search_for_pattern"]({
    substring_pattern: "router\\.(get|post|put|delete)",
    relative_path: "src/routes",
    context_lines_after: 3
  });
